npm warn config production Use `--omit=dev` instead.
> smart-taxis-mvp@1.0.0 start
> node app.js
ðŸš€ Smart Taxis MVP server running on port 3000
ðŸ“± Access the app at: http://localhost:3000
Executing (default): SELECT 1+1 AS result
Database connection established successfully.
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'drivers'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_drivers_status' GROUP BY 1
Executing (default): SELECT pk.constraint_type as "Constraint",c.column_name as "Field", c.column_default as "Default",c.is_nullable as "Null", (CASE WHEN c.udt_name = 'hstore' THEN c.udt_name ELSE c.data_type END) || (CASE WHEN c.character_maximum_length IS NOT NULL THEN '(' || c.character_maximum_length || ')' ELSE '' END) as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special", (SELECT pgd.description FROM pg_catalog.pg_statio_all_tables AS st INNER JOIN pg_catalog.pg_description pgd on (pgd.objoid=st.relid) WHERE c.ordinal_position=pgd.objsubid AND c.table_name=st.relname) AS "Comment" FROM information_schema.columns c LEFT JOIN (SELECT tc.table_schema, tc.table_name, cu.column_name, tc.constraint_type FROM information_schema.TABLE_CONSTRAINTS tc JOIN information_schema.KEY_COLUMN_USAGE  cu ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name and tc.constraint_name=cu.constraint_name and tc.constraint_type='PRIMARY KEY') pk ON pk.table_schema=c.table_schema AND pk.table_name=c.table_name AND pk.column_name=c.column_name WHERE c.table_name = 'drivers' AND c.table_schema = 'public'
Executing (default): SELECT DISTINCT tc.constraint_name as constraint_name, tc.constraint_schema as constraint_schema, tc.constraint_catalog as constraint_catalog, tc.table_name as table_name,tc.table_schema as table_schema,tc.table_catalog as table_catalog,tc.initially_deferred as initially_deferred,tc.is_deferrable as is_deferrable,kcu.column_name as column_name,ccu.table_schema  AS referenced_table_schema,ccu.table_catalog  AS referenced_table_catalog,ccu.table_name  AS referenced_table_name,ccu.column_name AS referenced_column_name FROM information_schema.table_constraints AS tc JOIN information_schema.key_column_usage AS kcu ON tc.constraint_name = kcu.constraint_name JOIN information_schema.constraint_column_usage AS ccu ON ccu.constraint_name = tc.constraint_name WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name = 'drivers' AND tc.table_catalog = 'Smart_taxi'
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "name" SET NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "name" DROP DEFAULT;ALTER TABLE "drivers" ALTER COLUMN "name" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "phone" SET NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "phone" DROP DEFAULT;ALTER TABLE "drivers"  ADD UNIQUE ("phone");ALTER TABLE "drivers" ALTER COLUMN "phone" TYPE VARCHAR(255)  ;
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "status" SET NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "status" SET DEFAULT 'available';DO 'BEGIN CREATE TYPE "public"."enum_drivers_status" AS ENUM(''available'', ''busy'', ''offline''); EXCEPTION WHEN duplicate_object THEN null; END';ALTER TABLE "drivers" ALTER COLUMN "status" TYPE "public"."enum_drivers_status" USING ("status"::"public"."enum_drivers_status");
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "current_location" DROP NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "current_location" SET DEFAULT 'Unknown';ALTER TABLE "drivers" ALTER COLUMN "current_location" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "created_at" DROP NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "created_at" DROP DEFAULT;ALTER TABLE "drivers" ALTER COLUMN "created_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "drivers" ALTER COLUMN "updated_at" SET NOT NULL;ALTER TABLE "drivers" ALTER COLUMN "updated_at" DROP DEFAULT;ALTER TABLE "drivers" ALTER COLUMN "updated_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'drivers' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'bookings'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_bookings_status' GROUP BY 1
Executing (default): SELECT pk.constraint_type as "Constraint",c.column_name as "Field", c.column_default as "Default",c.is_nullable as "Null", (CASE WHEN c.udt_name = 'hstore' THEN c.udt_name ELSE c.data_type END) || (CASE WHEN c.character_maximum_length IS NOT NULL THEN '(' || c.character_maximum_length || ')' ELSE '' END) as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special", (SELECT pgd.description FROM pg_catalog.pg_statio_all_tables AS st INNER JOIN pg_catalog.pg_description pgd on (pgd.objoid=st.relid) WHERE c.ordinal_position=pgd.objsubid AND c.table_name=st.relname) AS "Comment" FROM information_schema.columns c LEFT JOIN (SELECT tc.table_schema, tc.table_name, cu.column_name, tc.constraint_type FROM information_schema.TABLE_CONSTRAINTS tc JOIN information_schema.KEY_COLUMN_USAGE  cu ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name and tc.constraint_name=cu.constraint_name and tc.constraint_type='PRIMARY KEY') pk ON pk.table_schema=c.table_schema AND pk.table_name=c.table_name AND pk.column_name=c.column_name WHERE c.table_name = 'bookings' AND c.table_schema = 'public'
Executing (default): SELECT DISTINCT tc.constraint_name as constraint_name, tc.constraint_schema as constraint_schema, tc.constraint_catalog as constraint_catalog, tc.table_name as table_name,tc.table_schema as table_schema,tc.table_catalog as table_catalog,tc.initially_deferred as initially_deferred,tc.is_deferrable as is_deferrable,kcu.column_name as column_name,ccu.table_schema  AS referenced_table_schema,ccu.table_catalog  AS referenced_table_catalog,ccu.table_name  AS referenced_table_name,ccu.column_name AS referenced_column_name FROM information_schema.table_constraints AS tc JOIN information_schema.key_column_usage AS kcu ON tc.constraint_name = kcu.constraint_name JOIN information_schema.constraint_column_usage AS ccu ON ccu.constraint_name = tc.constraint_name WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name = 'bookings' AND tc.table_catalog = 'Smart_taxi'
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "customer_name" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "customer_name" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "customer_name" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "pickup_location" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "pickup_location" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "pickup_location" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "dropoff_location" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "dropoff_location" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "dropoff_location" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "fare" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "fare" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "fare" TYPE DECIMAL(10,2);
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "status" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "status" SET DEFAULT 'pending';DO 'BEGIN CREATE TYPE "public"."enum_bookings_status" AS ENUM(''pending'', ''assigned'', ''in_progress'', ''completed'', ''cancelled''); EXCEPTION WHEN duplicate_object THEN null; END';ALTER TABLE "bookings" ALTER COLUMN "status" TYPE "public"."enum_bookings_status" USING ("status"::"public"."enum_bookings_status");
Executing (default): ALTER TABLE "bookings" DROP CONSTRAINT "bookings_driver_id_fkey"
Executing (default): ALTER TABLE "bookings"  ADD FOREIGN KEY ("driver_id") REFERENCES "drivers" ("id") ON DELETE SET NULL ON UPDATE CASCADE;
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "created_at" DROP NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "created_at" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "created_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "bookings" ALTER COLUMN "updated_at" SET NOT NULL;ALTER TABLE "bookings" ALTER COLUMN "updated_at" DROP DEFAULT;ALTER TABLE "bookings" ALTER COLUMN "updated_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'bookings' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'missions'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_missions_status' GROUP BY 1
Executing (default): SELECT pk.constraint_type as "Constraint",c.column_name as "Field", c.column_default as "Default",c.is_nullable as "Null", (CASE WHEN c.udt_name = 'hstore' THEN c.udt_name ELSE c.data_type END) || (CASE WHEN c.character_maximum_length IS NOT NULL THEN '(' || c.character_maximum_length || ')' ELSE '' END) as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special", (SELECT pgd.description FROM pg_catalog.pg_statio_all_tables AS st INNER JOIN pg_catalog.pg_description pgd on (pgd.objoid=st.relid) WHERE c.ordinal_position=pgd.objsubid AND c.table_name=st.relname) AS "Comment" FROM information_schema.columns c LEFT JOIN (SELECT tc.table_schema, tc.table_name, cu.column_name, tc.constraint_type FROM information_schema.TABLE_CONSTRAINTS tc JOIN information_schema.KEY_COLUMN_USAGE  cu ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name and tc.constraint_name=cu.constraint_name and tc.constraint_type='PRIMARY KEY') pk ON pk.table_schema=c.table_schema AND pk.table_name=c.table_name AND pk.column_name=c.column_name WHERE c.table_name = 'missions' AND c.table_schema = 'public'
Executing (default): SELECT DISTINCT tc.constraint_name as constraint_name, tc.constraint_schema as constraint_schema, tc.constraint_catalog as constraint_catalog, tc.table_name as table_name,tc.table_schema as table_schema,tc.table_catalog as table_catalog,tc.initially_deferred as initially_deferred,tc.is_deferrable as is_deferrable,kcu.column_name as column_name,ccu.table_schema  AS referenced_table_schema,ccu.table_catalog  AS referenced_table_catalog,ccu.table_name  AS referenced_table_name,ccu.column_name AS referenced_column_name FROM information_schema.table_constraints AS tc JOIN information_schema.key_column_usage AS kcu ON tc.constraint_name = kcu.constraint_name JOIN information_schema.constraint_column_usage AS ccu ON ccu.constraint_name = tc.constraint_name WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name = 'missions' AND tc.table_catalog = 'Smart_taxi'
Executing (default): ALTER TABLE "missions" DROP CONSTRAINT "missions_booking_id_fkey"
Executing (default): ALTER TABLE "missions" ALTER COLUMN "booking_id" SET NOT NULL;ALTER TABLE "missions"  ADD FOREIGN KEY ("booking_id") REFERENCES "bookings" ("id") ON DELETE CASCADE ON UPDATE CASCADE;
Executing (default): ALTER TABLE "missions" ALTER COLUMN "status" SET NOT NULL;ALTER TABLE "missions" ALTER COLUMN "status" SET DEFAULT 'assigned';DO 'BEGIN CREATE TYPE "public"."enum_missions_status" AS ENUM(''assigned'', ''en_route'', ''arrived'', ''in_progress'', ''completed'', ''cancelled''); EXCEPTION WHEN duplicate_object THEN null; END';ALTER TABLE "missions" ALTER COLUMN "status" TYPE "public"."enum_missions_status" USING ("status"::"public"."enum_missions_status");
Executing (default): ALTER TABLE "missions" ALTER COLUMN "start_time" DROP NOT NULL;ALTER TABLE "missions" ALTER COLUMN "start_time" DROP DEFAULT;ALTER TABLE "missions" ALTER COLUMN "start_time" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "missions" ALTER COLUMN "end_time" DROP NOT NULL;ALTER TABLE "missions" ALTER COLUMN "end_time" DROP DEFAULT;ALTER TABLE "missions" ALTER COLUMN "end_time" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "missions" ALTER COLUMN "created_at" DROP NOT NULL;ALTER TABLE "missions" ALTER COLUMN "created_at" DROP DEFAULT;ALTER TABLE "missions" ALTER COLUMN "created_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "missions" ALTER COLUMN "updated_at" SET NOT NULL;ALTER TABLE "missions" ALTER COLUMN "updated_at" DROP DEFAULT;ALTER TABLE "missions" ALTER COLUMN "updated_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'missions' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Executing (default): SELECT table_name FROM information_schema.tables WHERE table_schema = 'public' AND table_name = 'users'
Executing (default): SELECT t.typname enum_name, array_agg(e.enumlabel ORDER BY enumsortorder) enum_value FROM pg_type t JOIN pg_enum e ON t.oid = e.enumtypid JOIN pg_catalog.pg_namespace n ON n.oid = t.typnamespace WHERE n.nspname = 'public' AND t.typname='enum_users_role' GROUP BY 1
Executing (default): SELECT pk.constraint_type as "Constraint",c.column_name as "Field", c.column_default as "Default",c.is_nullable as "Null", (CASE WHEN c.udt_name = 'hstore' THEN c.udt_name ELSE c.data_type END) || (CASE WHEN c.character_maximum_length IS NOT NULL THEN '(' || c.character_maximum_length || ')' ELSE '' END) as "Type", (SELECT array_agg(e.enumlabel) FROM pg_catalog.pg_type t JOIN pg_catalog.pg_enum e ON t.oid=e.enumtypid WHERE t.typname=c.udt_name) AS "special", (SELECT pgd.description FROM pg_catalog.pg_statio_all_tables AS st INNER JOIN pg_catalog.pg_description pgd on (pgd.objoid=st.relid) WHERE c.ordinal_position=pgd.objsubid AND c.table_name=st.relname) AS "Comment" FROM information_schema.columns c LEFT JOIN (SELECT tc.table_schema, tc.table_name, cu.column_name, tc.constraint_type FROM information_schema.TABLE_CONSTRAINTS tc JOIN information_schema.KEY_COLUMN_USAGE  cu ON tc.table_schema=cu.table_schema and tc.table_name=cu.table_name and tc.constraint_name=cu.constraint_name and tc.constraint_type='PRIMARY KEY') pk ON pk.table_schema=c.table_schema AND pk.table_name=c.table_name AND pk.column_name=c.column_name WHERE c.table_name = 'users' AND c.table_schema = 'public'
Executing (default): SELECT DISTINCT tc.constraint_name as constraint_name, tc.constraint_schema as constraint_schema, tc.constraint_catalog as constraint_catalog, tc.table_name as table_name,tc.table_schema as table_schema,tc.table_catalog as table_catalog,tc.initially_deferred as initially_deferred,tc.is_deferrable as is_deferrable,kcu.column_name as column_name,ccu.table_schema  AS referenced_table_schema,ccu.table_catalog  AS referenced_table_catalog,ccu.table_name  AS referenced_table_name,ccu.column_name AS referenced_column_name FROM information_schema.table_constraints AS tc JOIN information_schema.key_column_usage AS kcu ON tc.constraint_name = kcu.constraint_name JOIN information_schema.constraint_column_usage AS ccu ON ccu.constraint_name = tc.constraint_name WHERE constraint_type = 'FOREIGN KEY' AND tc.table_name = 'users' AND tc.table_catalog = 'Smart_taxi'
Executing (default): ALTER TABLE "users" ALTER COLUMN "username" SET NOT NULL;ALTER TABLE "users" ALTER COLUMN "username" DROP DEFAULT;ALTER TABLE "users"  ADD UNIQUE ("username");ALTER TABLE "users" ALTER COLUMN "username" TYPE VARCHAR(255)  ;
Executing (default): ALTER TABLE "users" ALTER COLUMN "email" SET NOT NULL;ALTER TABLE "users" ALTER COLUMN "email" DROP DEFAULT;ALTER TABLE "users"  ADD UNIQUE ("email");ALTER TABLE "users" ALTER COLUMN "email" TYPE VARCHAR(255)  ;
Executing (default): ALTER TABLE "users" ALTER COLUMN "password" SET NOT NULL;ALTER TABLE "users" ALTER COLUMN "password" DROP DEFAULT;ALTER TABLE "users" ALTER COLUMN "password" TYPE VARCHAR(255);
Executing (default): ALTER TABLE "users" ALTER COLUMN "role" SET NOT NULL;ALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 'driver';DO 'BEGIN CREATE TYPE "public"."enum_users_role" AS ENUM(''admin'', ''driver''); EXCEPTION WHEN duplicate_object THEN null; END';ALTER TABLE "users" ALTER COLUMN "role" TYPE "public"."enum_users_role" USING ("role"::"public"."enum_users_role");
Executing (default): ALTER TABLE "users" DROP CONSTRAINT "users_driver_id_fkey"
Executing (default): ALTER TABLE "users"  ADD FOREIGN KEY ("driver_id") REFERENCES "drivers" ("id") ON DELETE SET NULL ON UPDATE CASCADE;
Executing (default): ALTER TABLE "users" ALTER COLUMN "created_at" DROP NOT NULL;ALTER TABLE "users" ALTER COLUMN "created_at" DROP DEFAULT;ALTER TABLE "users" ALTER COLUMN "created_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): ALTER TABLE "users" ALTER COLUMN "updated_at" SET NOT NULL;ALTER TABLE "users" ALTER COLUMN "updated_at" DROP DEFAULT;ALTER TABLE "users" ALTER COLUMN "updated_at" TYPE TIMESTAMP WITH TIME ZONE;
Executing (default): SELECT i.relname AS name, ix.indisprimary AS primary, ix.indisunique AS unique, ix.indkey AS indkey, array_agg(a.attnum) as column_indexes, array_agg(a.attname) AS column_names, pg_get_indexdef(ix.indexrelid) AS definition FROM pg_class t, pg_class i, pg_index ix, pg_attribute a WHERE t.oid = ix.indrelid AND i.oid = ix.indexrelid AND a.attrelid = t.oid AND t.relkind = 'r' and t.relname = 'users' GROUP BY i.relname, ix.indexrelid, ix.indisprimary, ix.indisunique, ix.indkey ORDER BY i.relname;
Database synchronized successfully.
âœ… Database connected and synchronized
Executing (default): SELECT count(*) AS "count" FROM "drivers" AS "Driver" WHERE "Driver"."status" = 'available';
ðŸ‘¥ Available drivers: 0
Executing (default): SELECT "id", "name", "phone", "status", "current_location", "created_at", "updated_at" FROM "drivers" AS "Driver";
Error loading homepage: EagerLoadingError [SequelizeEagerLoadingError]: Driver is associated to Booking using an alias. You must use the 'as' keyword to specify the alias within your include statement.
at Booking._getIncludedAssociation (/app/node_modules/sequelize/lib/model.js:576:13)
at Booking._validateIncludedElement (/app/node_modules/sequelize/lib/model.js:502:53)
at /app/node_modules/sequelize/lib/model.js:421:37
at Array.map (<anonymous>)
at Booking._validateIncludedElements (/app/node_modules/sequelize/lib/model.js:417:39)
at Booking.findAll (/app/node_modules/sequelize/lib/model.js:1124:12)
at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
at async getBookings (/app/app.js:96:12)
at async /app/app.js:148:28